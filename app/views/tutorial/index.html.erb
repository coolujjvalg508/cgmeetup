<div id="myApp2" ng-app="myApp" ng-controller="myCtrl">

	<!-- Submenu Navigation -->
	<section class="wip-navigation-wrap">
		<div class="navbar-default">
	    	<div class="container-fluid">
	      		<div class="row">
	      
	      			<div class="col-md-3 col-sm-4 col-xs-9 header-search">
	      				<div class="input-group stylish-input-group">
	          				<input type="text" class="form-control"  placeholder="Search 520 000 3D models" >
	      					<span class="input-group-addon">
	      						<button type="submit"> <span class="glyphicon glyphicon-search"></span> </button>
	      					</span> 
	      				</div>
	      			</div>
	      
	      			<div class="col-md-9 col-sm-8 col-xs-3 downloadpage">
	      				<div class="navbar-header"> 
	      					<a class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </a> 
	      				</div>
	      				<div class="navbar-collapse collapse" id="bs-example-navbar-collapse-1">
	        				<ul class="nav navbar-nav">
								<li class="active"><a href="#">All Tutorials</a></li>
								<li><a href="#">maya</a></li>
								<li><a href="#">3ds Max</a></li>
								<li><a href="#">Blender</a></li>
								<li><a href="#">ZBrush</a></li>
								<li><a href="#">Cinema 4D</a></li>
								<li><a href="#">Houdini</a></li>
								<li><a href="#">Arnold Render</a></li>
								<li><a href="#">V-Ray Render</a></li>
								<li><a href="#">Photoshop</a></li>
								<li><a href="#">RealFlow</a></li>
								<li><a href="#">more</a></li>
							</ul>
						</div>
					</div>
	      		</div>
	    	</div>
	  	</div>
	</section>

	<!-- Showcase & Discover Creative Work -->
	<section class="clearfix downloadwrap text-center">
		<div class="container">
			<div class="download-title text-center">Free Tutorials CG, 3D, 2D, VFX, CAD, Games &amp; more</div>
			<div class="download-txt text-center">for <a href="#">Maya<i></i></a>, <a href="#">Blender<i></i></a>, <a href="#">Cinema 4D<i></i></a>, <a href="#">3Ds Max<i></i></a>, <a href="#">Photoshop<i></i></a> and more</div>

			<div class="clearfix download-gallery-wrap">
				<div class="col-md-3 col-sm-3 col-xs-12 marginB10 ColPad">
					<div class="input-group stylish-input-group">
						<input type="text" class="form-control"  placeholder="Enter a keyword..." >
						<span class="input-group-addon">
							<button type="submit"> <span class="glyphicon glyphicon-search"></span> </button>
						</span> 
					</div>
				</div>
				<div class="col-md-2 col-sm-3 col-xs-12 marginB10 text-left ColPad">
					<select class="custom-select">
						<option>Tutorials</option>
					</select>
				</div>
				<div class="col-md-2 col-sm-4 col-xs-12 marginB10 text-left ColPad">
					<select class="custom-select">
						<option>Category</option>
					</select>
				</div>
				<div class="col-md-3 col-sm-4 col-xs-12 marginB10 text-left ColPad">
					<select class="custom-select">
						<option>Sub Category</option>
					</select>
				</div>
				<strong>
					<div class="col-md-2 col-sm-4 col-xs-12 marginB10 text-left ColPad">
						<select class="custom-select">
							<option>Filter</option>
						</select>
					</div>
				</strong> 
			</div>
			<div class="showcase-btn-wrap clearfix text-center">
				<button type="button" class="btn btn-success border-radius marginB10">Submit</button>
				<button type="button" class="btn btn-default border-radius marginB10">Top Viewed</button>
				<button type="button" class="btn btn-default border-radius marginB10">Top Sold</button>
				<button type="button" class="btn btn-default border-radius marginB10">Browse Latest Tutorials</button>
			</div>
		</div>
	</section>

	<!-- Download Content Start -->
	<section class="clearfix browseallcompanies">
		<div class="clearfix wipwrap">
			<div class="wiptabs clearfix">
				<ul class="nav nav-pills">
	  				<li class="dropdown active"> 
	  					<a href="#" data-toggle="dropdown" class="dropdown-toggle">
	  						<i class="fa fa-th txt15 marginR5" aria-hidden="true"></i> Topic
	    					<div class="wip-down"><i class="fa fa-angle-down" aria-hidden="true"></i></div>
	    				</a>
	    				<ul class="dropdown-menu">
	      					<li>
			                 	<a href="javascript:void(0);" ng-click="searchByTopic('all')" class="active topic-link"  id="topic-link-all">All</a>
	              			</li>
							<% @topics.each do |val| %>
								<li>
									<a href="javascript:void(0);" ng-click="searchByTopic('<%= val['id'] %>')" class="topic-link"  id="topic-link-<%= val['id'] %>">
										<%= val['name'] %>
									</a>
								</li>
							<% end %>
	    				</ul>
	  				</li>

					<li class="dropdown"> 
						<a href="#" data-toggle="dropdown" class="dropdown-toggle">Sub Topic<div class="wip-down"><i class="fa fa-angle-down" aria-hidden="true"></i></div></a>
						<ul class="dropdown-menu">
							<li>
								<a href="javascript:void(0);" ng-click="searchBySubTopic('all')" class="active sub-topic-link"  id="sub-topic-link-all">All</a>
							</li>

							<li class="clearfix" ng-repeat="x in sub_topic_data">
								<a href="javascript:void(0);" ng-click="searchBySubTopic(x.id)" class="sub-topic-link"  id="sub-topic-link-{{x.id}}">{{x.name}}</a>
							</li>
						</ul>
					</li>
					<li class="dropdown"> 
						<a href="#" data-toggle="dropdown" class="dropdown-toggle">Skill Level <div class="wip-down"><i class="fa fa-angle-down" aria-hidden="true"></i></div></a>
						<ul class="dropdown-menu">
							<li>
								<a href="javascript:void(0);" ng-click="searchBySkillLevel('', 'all')" class="active skill-level-link" id="skill-level-link-all">All</a>
							</li>
								
							<% i = 1 
							Tutorial::SKILL_LEVEL.each do |val| %>
								<li>
									<a href="javascript:void(0);" ng-click="searchBySkillLevel('<%= val %>', '<%= i %>')" class="skill-level-link"  id="skill-level-link-<%= i %>"><%= val %></a>
								</li>
							<%  i = i + 1
							end %>
						</ul>
					</li>
					<li class="dropdown"> <a href="#" data-toggle="dropdown" class="dropdown-toggle">Featured
					  <div class="wip-down"><i class="fa fa-angle-down" aria-hidden="true"></i></div>
					  </a>
					  <ul class="dropdown-menu">
					    <li><a href="javascript:void(0);" ng-click="searchByFeatured('', 'all')" class="active featured-type-link"  id="featured-type-link-all">All</a></li>
					    <li><a href="javascript:void(0);" ng-click="searchByFeatured('1', 'yes')" class="featured-type-link"  id="featured-type-link-yes">Show Only Featured</a></li>
					    <li><a href="javascript:void(0);" ng-click="searchByFeatured('0', 'no')" class="featured-type-link"  id="featured-type-link-no">Show Without Featured</a></li>

					  </ul>
					</li>
				</ul>
			</div>
		</div>	

		<!-- User Followers Start -->
		<div class="container-fluid download-indent clearfix">
			<div class="container">
				


				<div class="clearfix downbox" ng-repeat="x in tutorial_data">
		  			<div class="clearfix downtop">
		    			<h2>{{x.Topic.name}}</h2>
		    				<a href="#" class="text-uppercase pull-right">view all</a> 
		    		</div>
		  			<div class="clearfix">
						<ul>
							<li class="clearfix" ng-repeat="y in x.Tutorial">
								<div class="downwrap">
									<img lazy-img="<%= root_url %>{{ y.company_logo.tutorial_list.url }}" class="img-responsive tutorial-img-height">
								</div>
								<div class="padding10 clearfix">
									<div class="down-txt">
										<span>{{y.title}}</span> <span class="pull-right tut-price">{{(y.free) ? 'Free' : '$' + y.price}}</span>
									</div>
									<div class="clearfix down-name">
										<div class="pull-left">by <span class="price-txt1">{{y.is_admin == 'Y' ? 'Admin' : y.user.firstname + ' ' + y.user.lastname}}</span></div>
										<div class="pull-right"> <span class="checkbox-btn">
											<input type="checkbox" value="value-1" id="rc{{y.id}}" name="rc1">
											<label for="rc{{y.id}}" onclick=""></label>
											</span> <a href="#"><i class="fa fa-shopping-cart fa-lg" aria-hidden="true"></i></a>
										</div>
									</div>
								</div>
							</li>
							
						</ul>
		  			</div>
				</div>

				<div class="clearfix downbox text-center err-msg no-result" ng-hide="tutorial_data.length" >No Result Found!</div>    


			</div>
		</div>
	</section>
</div>	

<!-- Footer Start -->
<footer class="footer clearfix padding">
 <%= render 'layouts/lastfooter' %>
</footer>

<script type="text/javascript">

  // main page angular app start
  var app = angular.module('myApp', ["angularLazyImg"]);
  app.controller('myCtrl', function($scope, $http) {
      
    $scope.filter = function() {
        
        list_url = '/tutorial/get_tutorial_list?';

        if(typeof $scope.viewFeaturedType !== 'undefined' && $scope.viewFeaturedType != '' && $scope.viewFeaturedType != 'all'){
          list_url += '&is_featured=' + $scope.viewFeaturedType
        }

        if(typeof $scope.viewSkillLevel !== 'undefined' && $scope.viewSkillLevel != '' && $scope.viewSkillLevel != 'all'){
          list_url += '&skill_level=' + $scope.viewSkillLevel
        }

        if(typeof $scope.viewTopic !== 'undefined' && $scope.viewTopic != '' && $scope.viewTopic != 'all'){
          list_url += '&topic=' + $scope.viewTopic
        }

        if(typeof $scope.viewSubTopic !== 'undefined' && $scope.viewSubTopic != '' && $scope.viewSubTopic != 'all'){
          list_url += '&sub_topic=' + $scope.viewSubTopic
        }

        $http.get(list_url).then(function (response) {
          $scope.tutorial_data = response.data;
        });
    };
    $scope.filter();

    $scope.searchByFeatured = function(value, id) {

      angular.element( document.querySelectorAll( '.featured-type-link' ) ).removeClass('active');
      angular.element( document.querySelector( '#featured-type-link-' + id ) ).addClass('active');
      
      $scope.viewFeaturedType = value;
      $scope.filter();

    };

    $scope.searchBySkillLevel = function(value, id) {

      angular.element( document.querySelectorAll( '.skill-level-link' ) ).removeClass('active');
      angular.element( document.querySelector( '#skill-level-link-' + id ) ).addClass('active');
      
      $scope.viewSkillLevel = value;
      $scope.filter();

    };

    $scope.searchByTopic = function(id) {

      angular.element( document.querySelectorAll( '.topic-link, .sub-topic-link' ) ).removeClass('active');
      angular.element( document.querySelectorAll( '#topic-link-' + id + ', #sub-topic-link-all' ) ).addClass('active');

      $scope.viewTopic = id;
      $scope.viewSubTopic = '';
      $scope.filter();
      $scope.getSubTopic();

    };

    $scope.searchBySubTopic = function(id) {
      
      angular.element( document.querySelectorAll( '.sub-topic-link' ) ).removeClass('active');
      angular.element( document.querySelectorAll( '#sub-topic-link-' + id ) ).addClass('active');
      
      $scope.viewSubTopic = id;
      $scope.filter();
    };

    $scope.getSubTopic = function() {
        
      $scope.sub_topic_data = [];

      if(typeof $scope.viewTopic !== 'undefined' && $scope.viewTopic != '' && $scope.viewTopic != 'all'){

        list_url = '/tutorial/get_topic_list?';
        list_url += '&parent_id=' + $scope.viewTopic;

        $http.get(list_url).then(function (response) {
          $scope.sub_topic_data = response.data;
        });
      }
        
    };

  });

  // main page angular app end

</script>