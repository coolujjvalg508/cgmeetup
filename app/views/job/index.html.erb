<!-- New Profile Section -->
<div class="artist-profile ng-scope">
  <div style="background-image: url(<%= asset_path 'artist-profile-masthead-gradient.png' %> ), url(<%= asset_path 'profile-user.jpg?1452532143' %> );" class="artist-masthead">
    <div class="change-cover-image hidden-xs"><a href="#"><i class="fa fa-pad-right fa-upload"></i><span class="text ng-binding">Change background (1920x640)</span></a></div>
    <div class="remove-cover-image hidden-xs"><a href="#"><i class="fa fa-pad-right fa-remove"></i><span class="text ng-binding">Remove Cover Art</span></a></div>
    <div class="container artist-info clearfix">
      <div class="row">
        <div class="col-sm-9 col-md-8 col-xs-12">


          <div class="avatar">
            <center>
            
            <% if (current_user.image.blank? || current_user.image.try(:event_small).blank?)%>
              <img src="/assets/profile-noimage.jpg" alt="User" class="img-thumbnail img-responsive">
            <% else %>
              <%= image_tag(current_user.image.try(:event_small).try(:url), alt: "User Image", class: "img-thumbnail img-responsive") %>
            <% end %>  
            <%#= image_tag("userprofile.jpg", :alt => "profile",:class=>"img-thumbnail") %><span class="user-pro-pic"><a href="#"><i class="fa fa-pad-right fa-remove"></i><span class="text ng-binding">Update Profile <span class="hidden-xs">Picture</span></span></a></span>
            </center>
          </div>
          <div class="artist-info-texts pull-left">
            <h2 class="artist-name ng-binding"><%= current_user.firstname + ' ' + current_user.lastname %> <i class="fa fa-check-circle"></i></h2>
            <div class="artist-additional-info">
              <ul>
                <li class="ng-binding"> <i class="fa fa-briefcase"></i> <%= current_user.profile_type %> </li>
              </ul>
              <div class="clearfix"></div>
            </div>
            <div class="artist-additional-info">
              <ul>
                <% if current_user.city || current_user.country %>
                  <li class="ng-binding"> <i class="fa fa-pad-right fa-map-marker"></i> <%= current_user.city %><%= (current_user.city != '' && current_user.country != '') ? ', ' : '' %><%= current_user.country %> </li>
                <% end %>
                <li class="ng-binding"> <i class="fa fa-pad-right fa-eye"></i> 114,660 Views </li>
                <li class="ng-binding"> <i class="fa fa-pad-right fa-thumbs-up"></i> 41,241 Likes </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-sm-3 col-md-4 col-xs-12 artist-social-info">
          <ul class="list-inline pull-right">
            <li class="ng-scope">
              <div aria-label="..." role="group" class="btn-group">
                <button type="button" title="Follow this user (F)" class="btn btn-primary btn-sm ng-binding ng-scope"> <i class="fa fa fa-plus-circle fa-pad-right"></i>Follow </button>
                <button class="btn btn-sm user-follow" type="button">4216</button>
              </div>
            </li>
            <li ng-if="artistCanContact" class="ng-scope">
              <button href="" class="btn btn-success btn-sm"> <i class="fa fa-pad-right fa-envelope"></i>Message </button>
            </li>
            <li ng-if="artistCanContact" class="ng-scope">
              <button href="" class="btn btn-warning btn-sm"> <i class="fa fa-globe fa-pad-right"></i>My Website </button>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>


<div ng-app="myApp" ng-controller="myCtrl">

  <!-- User Profile Menu -->
  <section class="usernavivation clearfix">
    <nav class="navbar-default clearfix">
      <div class="container">
        <div class="navbar-artist-profile clearfix">
          <ul class="nav navbar-nav">
            <li class="dropdown ng-scope"> <a href="user-profile.html">Portfolio <i class="fa fa-chevron-down fa-pad-left blue-txt"></i></a></li>
            <li> <a href="user-profile-info.html">About</a> </li>
            <li class="active"> <a href="jobs.html"> Jobs </a> </li>
            <li> <a href="user-following.html"> Following <span class="counter-number ng-binding">(13)</span> </a> </li>
            <li> <a href="user-like.html"> Like<span class="counter-number ng-binding">(20)</span> </a> </li>
            <li class=""> <a aria-expanded="false" href="#" data-toggle="dropdown" class="dropdown-toggle"> More <i class="fa fa-chevron-down fa-pad-left  blue-txt"></i> </a>
              <ul class="dropdown-menu ng-scope">
                <li class="ng-scope"> <a href="#" class="ng-binding"> <i class="fa fa-fw fa-pad-right fa-folder"></i> Forum Post (12) </a> </li>
                <li class="ng-scope"> <a href="#" class="ng-binding"> <i class="fa fa-fw fa-pad-right fa-folder"></i> Followers (13) </a> </li>
                <li class="ng-scope"> <a href="#" class="ng-binding"> <i class="fa fa-fw fa-pad-right fa-folder"></i> Jobs (7) </a> </li>
                <li class="ng-scope"> <a href="#" class="ng-binding"> <i class="fa fa-bar-chart"></i> Stats </a> </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="clearfix hidden-xs">
      <ul class="nav nav-pills">
        <li class="paddinT10 paddinB10">
          <input type="text" placeholder="Search" class="form-control from-input" ng-model="search">
        </li>

        <li class="dropdown pull-right recentdrop" role="presentation"> <a aria-expanded="false" aria-haspopup="true" role="button" href="#" data-toggle="dropdown" class="dropdown-toggle">Recent <i class="fa fa-chevron-down fa-pad-left  blue-txt"></i> </a>
          <ul class="dropdown-menu">
            <li><a href="#">Last Name</a></li>
            <li><a href="#">Recent </a></li>
          </ul>
        </li>

        <li class="dropdown pull-right recentdrop" role="presentation"> <a aria-expanded="false" aria-haspopup="true" role="button" href="#" data-toggle="dropdown" class="dropdown-toggle">Job Type <i class="fa fa-chevron-down fa-pad-left  blue-txt"></i> </a>
          <ul class="dropdown-menu">

            <li><a href="javascript:void(0);" ng-click="setJobType('', '0')" class="active job-type-link"  id="job-type-link-0">All</a></li>
            <% job_type = JobCategory.order('name ASC').pluck(:name, :id)

              job_type.each do |val| %>
                <li><a href="javascript:void(0);" ng-click="setJobType('<%= val[0] %>', '<%= val[1] %>')" class="active job-type-link" id="job-type-link-<%= val[1] %>"><%= val[0] %></a></li>
            <% end %>
          </ul>
          <input type="hidden" ng-model="viewJobType" value="">


        </li>

        <li class="pull-right location-txt-drop"> Location</li>

      </ul>
    </div>
  </section>

  <!-- User Followers Start -->
  <section class="clearfix jobs-wrap">
    <div class="col-md-12">
      <ul class="margin"> 
        <li class="clearfix" dir-paginate="x in job_data|filter:search|itemsPerPage:10">

          <div class="jobs-post-left pull-left">
            <img lazy-img="<%= root_url %>{{ x.company_logo.thumb.url }}" class="img-responsive">
          </div>
   
          <div class="jobs-content clearfix pull-left">
            <div class="jobs-title marginB15"><a href="#">{{x.title}}</a></div>
            <div class="white-txt marginB15">{{x.company.name}}</div>
            <div class="jobs-view-txt txt12 marginB15">{{x.created_at | date:'dd MMMM yyyy'}} - 5,116 views</div>
            <div class="jobs-blue txt13"><i class="fa fa-bookmark marginR5" aria-hidden="true"></i> {{x.job_type}}</div>
          </div>

          <div class="jobs-location-right pull-right"><i class="fa fa-map-marker marginR5" aria-hidden="true"></i> {{x.city}}, {{x.country}}</div>         

        </li>

        <li ng-hide="job_data.length" class="text-center err-msg no-result">No Result Found!</li>
        
      </ul>    
    </div>

    <div class="text-center text-uppercase">
      <dir-pagination-controls
         max-size="1"
         direction-links="true"
         boundary-links="true" >
      </dir-pagination-controls>
    </div>

  </section>

</div>

<!-- Footer Start -->
<footer class="footer clearfix padding">
  <%= render 'layouts/lastfooter' %>
</footer>

<script>
  var app = angular.module('myApp', ["angularUtils.directives.dirPagination", "angularLazyImg"]);
  app.controller('myCtrl', function($scope, $http) {

      
    $scope.filter = function() {
        
        list_url = '/job/get_job_list?';

        if(typeof $scope.viewJobType !== 'undefined' && $scope.viewJobType != '' && $scope.viewJobType != 'all'){
          list_url += '&job_type=' + $scope.viewJobType
        }

        $http.get(list_url).then(function (response) {
          $scope.job_data = response.data;
        });
    };
    $scope.filter();

    $scope.setJobType = function(value, id) {

      angular.element( document.querySelectorAll( '.job-type-link' ) ).removeClass('active');
      angular.element( document.querySelector( '#job-type-link-' + id ) ).addClass('active');
      
      $scope.search = '';
      $scope.viewJobType = value;
      $scope.filter();

    };
      
  });

</script>