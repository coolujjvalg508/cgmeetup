<section class="searchpage clearfix">
  <div class="container">
    <h2>COLLECTIONS</h2>
    <div><a href='<%= index_collection_path %>'>Collections</a>/ <%= @collection.title %><br/></div>
    <div class="searchwrap clearfix">
      <div class="form-group marginB40">
        <center>
         <!--   <button type="button" class="lightbtn txt16" data-toggle="modal" data-target="#editCollectionModal">Edit</button> -->
            <a href='' class='lightbtn txt16' data-toggle="modal" data-target="#editCollectionModal">Update</a>
           <%= link_to 'Delete'.html_safe, collectiondelete_path(@collection.id), class: 'lightbtn txt16', data: { confirm: "Are you sure you want to delete this collection?" } %>
           <!-- <button type="button" class="lightbtn txt16" data-toggle="modal" data-target="#deleteCollectionModal">Delete</button> -->
        </center>
      </div>
    </div>

        <div class="clearfix downboxcollection">
          <div class="clearfix">
          <%  if @collection.gallery.present? %>
            <ul>
                <% 
                   src = '' 
                   @collection.gallery.images.each_with_index do | collectionimage, index |
                          if index == 1
                              break
                          end  
                          src =  collectionimage.image.large_image.url
                      end  
                                   
                  %>
                    <li class="clearfix">
                        <div class="downwrap">
                          <a href='<%= show_gallery_path(@collection.gallery.paramlink) %>'>
                            <img src="<%= src %>" class="img-responsive tutorial-img-height">
                          </a>
                        </div>
                        <div class="padding10 clearfix">
                            <div class="down-txt">
                              <span><%= link_to @collection.title, show_gallery_path(@collection.gallery.paramlink) %></span> <span class="pull-right tut-price"></span>
                            </div>
                            <div class="clearfix down-name">
                              <div class="pull-left"><span class="price-txt1"></span></div>
                            </div>
                        </div>
                    </li>
         
            </ul>

            <% end %>
          </div>
        </div>

  </div>

      <div class="modal fade default-popup" id="editCollectionModal" tabindex="-1" role="dialog" aria-labelledby="editCollectionModalLabel">
      <div class="modal-dialog" role="document">
        <%= form_for(@collection, :html => {:id => 'edit_bookmark_form_popup'}, :url => 'javascript:void(0);') do |f| %>
        <%= f.hidden_field :collection_id, value: @collection.id %> 

          <div class="modal-content">
            <div class="modal-header">
             <button type="button" class="close" data-dismiss="modal"></button>
              <h4 class="modal-title" id="exampleModalLabel">Edit Collection</h4>
            </div>
            <div class="modal-body">
               <div class="form-group">
                  <label for="recipient-name" class="control-label">Collection Name:</label>
                  <%= f.text_field :title, :autofocus => true, :placeholder => "Collection Name", class:"form-control", :type => 'text' %>
                  <span class="err-msg" id='bookmark_error_msg'><%= form_error_msg_for(@collection,:title, "Collection") %></span>
                </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="lightbtn" data-dismiss="modal">Close</button>
              <button type="submit" class="lightbtn">Edit</button>
            </div>
          </div>
        <% end %>  


      </div>
    </div>
 
</section>
<script>
$(document).ready(function() {
   $('#edit_bookmark_form_popup').on('submit',function(){
    //alert('ghdfg');
             $.ajax({
              type: "post",
              url: "<%= update_collection_path %>" ,
              data: $('#edit_bookmark_form_popup').serialize(),
              success: function(data){
                  if(data.res == 0){
                      $('#bookmark_error_msg').html('');
                      $('#bookmark_error_msg').html(data.message);
                  }else{
                      window.location.reload(true);

                  }
                  

              }
            });
    });

});
</script>